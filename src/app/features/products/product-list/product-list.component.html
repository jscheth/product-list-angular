<div class="product-list-container">

  <!-- ðŸ” Toolbar: Search / Filter / Sort -->
  <div class="toolbar">
    <mat-form-field appearance="outline" class="toolbar-field">
      <mat-label>Search</mat-label>
      <input
        matInput
        type="text"
        placeholder="Search products..."
        [formControl]="searchControl"
      />
    </mat-form-field>

    <mat-form-field appearance="outline" class="toolbar-field">
      <mat-label>Category</mat-label>
      <mat-select [formControl]="categoryControl">
        <mat-option value="all">All</mat-option>
        <mat-option value="Machines">Machines</mat-option>
        <mat-option value="Heat Press">Heat Press</mat-option>
        <mat-option value="Materials">Materials</mat-option>
        <mat-option value="Accessories">Accessories</mat-option>
      </mat-select>
    </mat-form-field>

    <mat-form-field appearance="outline" class="toolbar-field">
      <mat-label>Sort by</mat-label>
      <mat-select [formControl]="sortControl">
        <mat-option value="title-asc">Title (Aâ€“Z)</mat-option>
        <mat-option value="title-desc">Title (Zâ€“A)</mat-option>
        <mat-option value="price-asc">Price (Low â†’ High)</mat-option>
        <mat-option value="price-desc">Price (High â†’ Low)</mat-option>
      </mat-select>
    </mat-form-field>
  </div>

  <!-- â³ Loading State -->
  <div class="state-container" *ngIf="isLoading$ | async">
    <mat-progress-spinner
      mode="indeterminate"
      diameter="50">
    </mat-progress-spinner>
  </div>

  <!-- âŒ Error State -->
  <div class="state-container error" *ngIf="(error$ | async) as error">
    <mat-icon color="warn">error</mat-icon>
    <span>{{ error }}</span>
  </div>

  <!-- ðŸ“¦ Product Table -->
  <ng-container *ngIf="!(isLoading$ | async) && !(error$ | async)">
    <ng-container *ngIf="(visibleProducts$ | async) as products">

      <!-- ðŸ«¥ Empty State -->
      <div class="state-container empty" *ngIf="products.length === 0">
        <mat-icon>inventory_2</mat-icon>
        <p>No products found.</p>
      </div>

      <!-- âœ… Table (Step 8 will replace this) -->
      <table class="basic-table" *ngIf="products.length > 0">
        <thead>
          <tr>
            <th>Image</th>
            <th>Title</th>
            <th>Category</th>
            <th>Price</th>
            <th>Status</th>
            <th></th>
          </tr>
        </thead>

        <tbody>
          <tr *ngFor="let product of products">
            <td>
              <img
                [src]="product.imageUrl"
                [alt]="product.title"
                class="product-image"
              />
            </td>
            <td>{{ product.title }}</td>
            <td>{{ product.category }}</td>
            <td>{{ product.price | currency }}</td>
            <td>
              <span class="status active">Active</span>
            </td>
            <td>
              <button
                mat-button
                color="warn"
                (click)="onDeactivateProduct(product.id)">
                Deactivate
              </button>
            </td>
          </tr>
        </tbody>
      </table>

    </ng-container>
  </ng-container>

</div>
